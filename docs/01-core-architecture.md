# π—οΈ ν•µμ‹¬ μ•„ν‚¤ν…μ²

> **Express.js-Kusto ν”„λ μ„μ›ν¬μ κΈ°λ³Έ κµ¬μ΅°**  
> Application ν΄λμ¤μ™€ Core μ‹μ¤ν…μ μ—­ν• κ³Ό λ™μ‘ λ°©μ‹μ„ μ΄ν•΄ν•©λ‹λ‹¤.

## π“‹ λ©μ°¨

- [μ„¤κ³„ μ² ν•™](#μ„¤κ³„-μ² ν•™)
- [κΈ°λ³Έ μ‚¬μ©λ²•](#κΈ°λ³Έ-μ‚¬μ©λ²•)
- [ν”„λ΅μ νΈ κµ¬μ΅°μ™€ κ΄€λ΅€](#ν”„λ΅μ νΈ-κµ¬μ΅°μ™€-κ΄€λ΅€)
- [μ„λ²„ μ‹μ‘ μ‹ μλ™ μ‹¤ν–‰](#μ„λ²„-μ‹μ‘-μ‹-μλ™-μ‹¤ν–‰)
- [ν•µμ‹¬ νΉμ§•](#ν•µμ‹¬-νΉμ§•)

## μ„¤κ³„ μ² ν•™

### Convention over Configuration (κ΄€λ΅€ μ°μ„  μ„¤μ •)

ν”„λ μ„μ›ν¬λ” **μ„¤μ •λ³΄λ‹¤λ” κ΄€λ΅€**λ¥Ό λ”°λ¦…λ‹λ‹¤. λ³µμ΅ν• μ„¤μ • νμΌ μ—†μ΄λ„ μ •ν•΄μ§„ ν΄λ” κµ¬μ΅°λ§ λ”°λ¥΄λ©΄ μλ™μΌλ΅ λ™μ‘ν•©λ‹λ‹¤.

### μλ™ν™” μ°μ„ 

κ°λ°μκ°€ λ°λ³µμ μΌλ΅ ν•΄μ•Ό ν•λ” μ‘μ—…λ“¤μ„ ν”„λ μ„μ›ν¬κ°€ μλ™μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤:
- λΌμ°νΈ νμΌ μλ™ νƒμƒ‰ λ° λ“±λ΅
- νƒ€μ… μ •μ μλ™ μƒμ„±
- λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μλ™ κ΄€λ¦¬

## κΈ°λ³Έ μ‚¬μ©λ²•

### ν”„λ΅μ νΈ μ‹μ‘ν•κΈ°

1. **ν”„λ΅μ νΈ ν΄λ΅  λ° μ„¤μΉ**:
```bash
git clone <repository-url>
cd express.js-kusto
npm install
```

2. **ν™κ²½ μ„¤μ •**:
```bash
cp .env.template .env
# .env νμΌμ„ μ—΄μ–΄μ„ ν•„μ”ν• μ„¤μ • μ…λ ¥
```

3. **κ°λ° μ„λ²„ μ‹¤ν–‰**:
```bash
npm run dev
```

4. **λΈλΌμ°μ €μ—μ„ ν™•μΈ**:
- http://localhost:3000 μ ‘μ†

## ν”„λ΅μ νΈ κµ¬μ΅°μ™€ κ΄€λ΅€

### ν΄λ” κµ¬μ΅°

```
src/
β”β”€β”€ core/                    # ν”„λ μ„μ›ν¬ ν•µμ‹¬ (κ±΄λ“λ¦¬μ§€ μ•μ)
β”‚   β”β”€β”€ Application.ts       # μ•± μ‹μ‘μ 
β”‚   β”β”€β”€ Core.ts             # λ‚΄λ¶€ μ‹μ¤ν…
β”‚   β”β”€β”€ lib/                # ν•µμ‹¬ κΈ°λ¥λ“¤
β”‚   β”” ...                   
β””β”€β”€ app/                    # κ°λ°μκ°€ μ‘μ—…ν•λ” μμ—­
    β”β”€β”€ routes/             # API μ„λΉ„μ¤ μ—”λ“ν¬μΈνΈ (.ts νμΌ)
    β”β”€β”€ views/              # HTML ν…ν”λ¦Ώ (.ejs νμΌ)
    β”β”€β”€ db/                 # λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§
    β”β”€β”€ repos/              # λ¦¬ν¬μ§€ν„°λ¦¬
    β””β”€β”€ injectable/         # μμ΅΄μ„± λ¬¶μ

```

### ν•µμ‹¬ κ΄€λ΅€λ“¤

#### 1. λΌμ°νΈ νμΌ κ΄€λ΅€

`app/routes/` ν΄λ”μ— λ‹¤μ νμΌλ“¤μ„ λ§λ“¤ μ μμµλ‹λ‹¤:

```
app/routes/
β”β”€β”€ route.ts              # λ£¨νΈ κ²½λ΅ (/)
β”β”€β”€ middleware.ts         # λ£¨νΈ λ―Έλ“¤μ›¨μ–΄
β””β”€β”€ authorities/
    β””β”€β”€ signin/
        β””β”€β”€ route.ts      # /authorities/signin κ²½λ΅
```

- **ν΄λ” κµ¬μ΅°** = **URL κ²½λ΅**: ν΄λ”λ…μ΄ κ·Έλ€λ΅ URLμ΄ λ©λ‹λ‹¤
- **route.ts**: μ‹¤μ  API μ—”λ“ν¬μΈνΈ μ •μ
- **middleware.ts**: ν•΄λ‹Ή κ²½λ΅μ λ―Έλ“¤μ›¨μ–΄ μ •μ

*μμ„Έν• λΌμ°ν… λ°©λ²•μ€ [λΌμ°ν… μ‹μ¤ν… λ¬Έμ„](./02-routing-system.md)μ—μ„ μ„¤λ…ν•©λ‹λ‹¤.*

#### 2. λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ΅€

`app/db/` ν΄λ”μ— κ° λ°μ΄ν„°λ² μ΄μ¤λ³„λ΅ ν΄λ”λ¥Ό λ§λ“­λ‹λ‹¤:

```
app/db/
β”β”€β”€ user/                 # μ‚¬μ©μ λ°μ΄ν„°λ² μ΄μ¤
β”‚   β”β”€β”€ schema.prisma     # Prisma μ¤ν‚¤λ§ (λ¨λΈ μ •μ)
β”‚   β””β”€β”€ client/           # μλ™ μƒμ„±λ ν΄λΌμ΄μ–ΈνΈ
β””β”€β”€ temporary/            # μ„μ‹ λ°μ΄ν„°λ² μ΄μ¤
    β”β”€β”€ schema.prisma
    β””β”€β”€ client/
```

**λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±**: 
- **κ° ν΄λ” = ν•λ‚μ λ°μ΄ν„°λ² μ΄μ¤**: ν΄λ”λ…μ΄ λ°μ΄ν„°λ² μ΄μ¤ μ‹λ³„μκ°€ λ©λ‹λ‹¤
- **schema.prisma**: λ°μ΄ν„° λ¨λΈ(ν…μ΄λΈ” κµ¬μ΅°)λ§ μ •μν•©λ‹λ‹¤
- **client/**: Prismaκ°€ μλ™ μƒμ„±ν• νƒ€μ… μ•μ „ν• ν΄λΌμ΄μ–ΈνΈμ…λ‹λ‹¤
- **λΉ„μ¦λ‹μ¤ λ΅μ§ λ¶„λ¦¬**: μ‹¤μ  λ°μ΄ν„° μ΅°μ‘ λ΅μ§μ€ Repositoryμ—μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤

#### 3. ν…ν”λ¦Ώ κ΄€λ΅€

`app/views/` ν΄λ”μ `.ejs` νμΌλ“¤μ΄ μλ™μΌλ΅ ν…ν”λ¦Ώ μ—”μ§„μ— λ“±λ΅λ©λ‹λ‹¤.

#### 4. Injectable κ΄€λ΅€

`app/injectable/` ν΄λ”μ—λ” μμ΅΄μ„± μ£Όμ…μ„ μ„ν• λ¨λ“λ“¤μ„ κµ¬μ„±ν•©λ‹λ‹¤:

```
app/injectable/
β”β”€β”€ auth/                 # μΈμ¦ κ΄€λ ¨ λ¨λ“
β”‚   β”β”€β”€ jwt/             # JWT ν† ν° μ²λ¦¬
β”‚   β”β”€β”€ csrf/            # CSRF λ³΄νΈ
β”‚   β””β”€β”€ rateLimiter/     # μ”μ²­ μ ν•
β””β”€β”€ ...                  # κΈ°νƒ€ λ¨λ“λ“¤
```

Injectableμ—μ„λ” λΌμ°ν„°μ—μ„ μ‚¬μ©ν•  μ™Έλ¶€ μμ΅΄μ„± μ½”λ“λ‚ λ―Έλ“¤μ›¨μ–΄, λ―Έλ“¤μ›¨μ–΄μ—μ„ μ‚¬μ©ν•  κ° νλΌλ―Έν„° μ •μλ¥Ό λ¨λ“ ν•μ‹μΌλ΅ κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
μ΄λ” λ¨λ‘ ν΄λ” λ° νμΌ λ…μΉ­μ„ κΈ°λ°μΌλ΅ ν• camelCase ν•μ‹μΌλ΅ ν‚¤μ›λ“κ°€ μƒμ„±λλ©°, `route.ts`μ—μ„ μ§μ ‘ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
import κµ¬λ¬Έ μ—†μ΄λ„ ν΄λ” κµ¬μ΅°κ°€ μλ™μΌλ΅ ν‚¤μ›λ“λ΅ λ³€ν™λμ–΄ μ ‘κ·Ό κ°€λ¥ν•λ©°, **νƒ€μ…μ΄ μ™„μ „ν μ§€μ›λμ–΄ μ—λ””ν„°μ—μ„ κ°„νΈν νΈμ¶ν•  μ μμµλ‹λ‹¤**.

#### 5. Repository κ΄€λ΅€

`app/repos/` ν΄λ”μ—λ” λ°μ΄ν„° μ•΅μ„Έμ¤ λ μ΄μ–΄λ¥Ό κµ¬μ„±ν•©λ‹λ‹¤:

```
app/repos/
β”β”€β”€ account/             # κ³„μ • κ΄€λ ¨ λ¦¬ν¬μ§€ν„°λ¦¬
β”‚   β”β”€β”€ user.repository.ts
β”‚   β”β”€β”€ user.types.ts
β”‚   β””β”€β”€ types.ts
β””β”€β”€ ...                  # κΈ°νƒ€ λ„λ©”μΈλ³„ λ¦¬ν¬μ§€ν„°λ¦¬
```

**DBμ™€ Repository κ΄€κ³„**:
- **1:1 κ΄€κ³„**: ν•λ‚μ DBμ— ν•λ‚μ Repository (μ: `user` DB β†’ `account/user.repository.ts`)
- **1:n κ΄€κ³„**: ν•λ‚μ DBμ— μ—¬λ¬ Repository (μ: `user` DB β†’ `account/user.repository.ts`, `profile/user.repository.ts`)
- **μ—­ν•  λ¶„λ¦¬**: 
  - **DB ν΄λ”**: λ°μ΄ν„° κµ¬μ΅°(μ¤ν‚¤λ§)μ™€ ν΄λΌμ΄μ–ΈνΈλ§ κ΄€λ¦¬
  - **Repository**: μ‹¤μ  λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ°μ΄ν„° μ΅°μ‘ μ²λ¦¬

κ° λ¦¬ν¬μ§€ν„°λ¦¬λ” νΉμ • λ„λ©”μΈμ λ°μ΄ν„° μ΅°μ‘μ„ λ‹΄λ‹Ήν•λ©°, λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ°μ΄ν„°λ² μ΄μ¤ μ•΅μ„Έμ¤λ¥Ό λ¶„λ¦¬ν•©λ‹λ‹¤.
ν΄λ” κµ¬μ΅°λ‚ νμΌλ…μ— λ”°λΌ camelCaseλ΅ ν‚¤μ›λ“κ°€ μλ™ μƒμ„±λλ©°, routes ν΄λ”μ λΌμ°ν„°μ—μ„ import μ—†μ΄ μ§μ ‘ νΈμ¶ν•μ—¬ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
**νƒ€μ…μ΄ μ™„μ „ν μ§€μ›λμ–΄ μ—λ””ν„°μ—μ„ κ°„νΈν νΈμ¶ν•  μ μμµλ‹λ‹¤**.

## μ„λ²„ μ‹μ‘ μ‹ μλ™ μ‹¤ν–‰

`npm run dev`λ¥Ό μ‹¤ν–‰ν•λ©΄ λ‹¤μμ΄ μλ™μΌλ΅ μΌμ–΄λ‚©λ‹λ‹¤:

1. **ν™κ²½ μ„¤μ • ν™•μΈ**: `.env` νμΌ λ΅λ“
2. **λΌμ°νΈ νƒμƒ‰**: `app/routes/` ν΄λ”μ νμΌλ“¤μ„ μ°Ύμ
3. **API λ“±λ΅**: ν΄λ” κµ¬μ΅°μ— λ”°λΌ URL κ²½λ΅ μλ™ μƒμ„±
4. **λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°**: `app/db/` ν΄λ”μ μ¤ν‚¤λ§λ“¤μ„ μλ™ μ—°κ²°
5. **μ„λ²„ μ‹¤ν–‰**: μ§€μ •λ ν¬νΈμ—μ„ HTTP μ„λ²„ μ‹μ‘



## ν•µμ‹¬ νΉμ§•

### 1. Convention over Configuration (CoC) ν¨λ¬λ‹¤μ„

**Ruby on Rails**μ—μ„ μ λ…ν•΄μ§„ μ„¤κ³„ μ›μΉ™μ„ λ”°λ¦…λ‹λ‹¤. λ³µμ΅ν• μ„¤μ • νμΌ μ—†μ΄ ν΄λ” κµ¬μ΅°κ°€ κ³§ URL κ²½λ΅κ°€ λλ” κ΄€λ΅€ κΈ°λ° μ‹μ¤ν…μ…λ‹λ‹¤.

```
app/routes/api/users/route.ts β†’ GET /api/users
app/routes/admin/dashboard/route.ts β†’ GET /admin/dashboard
```

### 2. Multi-tenant Architecture (λ©€ν‹° ν…λ„νΈ μ•„ν‚¤ν…μ²)

**SaaS μ• ν”λ¦¬μΌ€μ΄μ…**μ—μ„ μ‚¬μ©ν•λ” ν¨ν„΄μΌλ΅, ν•λ‚μ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ—¬λ¬ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό λ™μ‹ κ΄€λ¦¬ν•©λ‹λ‹¤. 

```
app/db/user/ β†’ μ‚¬μ©μ λ°μ΄ν„°λ² μ΄μ¤ (μ¤ν‚¤λ§ + ν΄λΌμ΄μ–ΈνΈ)
app/db/analytics/ β†’ λ¶„μ„ λ°μ΄ν„°λ² μ΄μ¤ (μ¤ν‚¤λ§ + ν΄λΌμ΄μ–ΈνΈ)
app/db/logs/ β†’ λ΅κ·Έ λ°μ΄ν„°λ² μ΄μ¤ (μ¤ν‚¤λ§ + ν΄λΌμ΄μ–ΈνΈ)
```

**μ„¤κ³„ μ›μΉ™**:
- **DB ν΄λ”**: μμ λ°μ΄ν„° κµ¬μ΅° μ •μ (Prisma μ¤ν‚¤λ§ + μλ™ μƒμ„± ν΄λΌμ΄μ–ΈνΈ)
- **Repository**: μ‹¤μ  λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ°μ΄ν„° μ΅°μ‘ μ²λ¦¬
- **κ΄€κ³„**: DBμ™€ Repositoryλ” 1:1 λλ” 1:n κ΄€κ³„λ΅ μ μ—°ν•κ² κµ¬μ„± κ°€λ¥

### 3. Dependency Injection (μμ΅΄μ„± μ£Όμ…) + Auto-wiring

**Spring Framework**μ ν•µμ‹¬ κ°λ…μΈ μμ΅΄μ„± μ£Όμ…μ„ TypeScript ν™κ²½μ— μ μ©ν–μµλ‹λ‹¤. ν΄λ” κµ¬μ΅° κΈ°λ°μΌλ΅ μλ™ νƒ€μ… μƒμ„± λ° Auto-wiringμ„ μ§€μ›ν•©λ‹λ‹¤.

### 4. Code Generation (μ½”λ“ μλ™ μƒμ„±)

**GraphQL Code Generator**λ‚ **Prisma Client**μ²λΌ Repository, Injectable ν΄λ”λ¥Ό κΈ°λ°μΌλ΅ TypeScript νƒ€μ…μ„ μλ™ μƒμ„±ν•©λ‹λ‹¤. ν΄λ”λ…κ³Ό νμΌλ…μ΄ camelCase ν‚¤μ›λ“λ΅ λ³€ν™λμ–΄ IntelliSense μ§€μ›λ©λ‹λ‹¤.

### 5. Zero Runtime Dependencies Import

**Deno**μ μ² ν•™μ„ μ°¨μ©ν•μ—¬ λ°νƒ€μ„μ—μ„ import κµ¬λ¬Έ μ—†μ΄ λ¨λ“  μμ΅΄μ„±μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤. μ»΄νμΌ νƒ€μ„μ— μμ΅΄μ„± κ·Έλν”„κ°€ κµ¬μ„±λμ–΄ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•©λ‹λ‹¤.

### 6. File-based Routing + Auto-discovery

**Next.js**μ νμΌ κΈ°λ° λΌμ°ν…κ³Ό **NestJS**μ Auto-discoveryλ¥Ό κ²°ν•©ν–μµλ‹λ‹¤. μ„λ²„ μ‹μ‘ μ‹ μλ™μΌλ΅ λΌμ°νΈ, λ―Έλ“¤μ›¨μ–΄, λ¦¬ν¬μ§€ν„°λ¦¬λ¥Ό μ¤μΊ”ν•κ³  λ“±λ΅ν•©λ‹λ‹¤.





---

## π“– λ¬Έμ„ λ„¤λΉ„κ²μ΄μ…

**β—€οΈ μ΄μ „**: [π“‹ λ¬Έμ„ μƒ‰μΈ](./00-documentation-index.md)  
**β–¶οΈ λ‹¤μ**: [π›£οΈ λΌμ°ν… μ‹μ¤ν…](./02-routing-system.md)
